var create_plugin = (function() {
	var m_plugin_host = null;
	var m_is_init = false;
	var m_forward_button = null;
	var m_operation_mode_button = null;
	var m_map_mode = false;
	var m_operator_pos = null;

	var m_status = [];
	var m_waypoints = [];
	var m_history = [];
	var m_get_waypoints_callback = null;
	var m_get_history_callback = null;
	var m_wp_mode;
	var set_wp_mode = null;

	var PLUGIN_NAME = "jetusv";
	var SYSTEM_DOMAIN = UPSTREAM_DOMAIN + UPSTREAM_DOMAIN;
	var SERVICE_DOMAIN = UPSTREAM_DOMAIN + "jetusv.";
	var MOVE_TIMEOUT = 60 * 1000;// 1min

	function button_svg(charactor, bgcolor) {
		var tmp = "%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0D%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0D%0A%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20preserveAspectRatio%3D%22xMidYMid%20meet%22%20viewBox%3D%220%200%20100%20100%22%20width%3D%22100%22%20height%3D%22100%22%3E%3Cdefs%3E%3Cpath%20d%3D%22M100%2050C100%2077.6%2077.6%20100%2050%20100C22.41%20100%200%2077.6%200%2050C0%2022.41%2022.41%200%2050%200C77.6%200%20100%2022.41%20100%2050Z%22%20id%3D%22e2iuzi5oh%22%3E%3C%2Fpath%3E%3Ctext%20id%3D%22d6VhEb28r%22%20x%3D%220%22%20y%3D%220%22%20font-size%3D%2274%22%20font-family%3D%22Open%20Sans%22%20font-weight%3D%22700%22%20font-style%3D%22normal%22%20letter-spacing%3D%220%22%20alignment-baseline%3D%22before-edge%22%20transform%3D%22matrix(1%200%200%201%20-9.189412406599615%20-53.60929047562422)%22%20style%3D%22line-height%3A100%25%22%20xml%3Aspace%3D%22preserve%22%20dominant-baseline%3D%22text-before-edge%22%3E%3Ctspan%20x%3D%22{XOFFSET}%22%20dy%3D%22{YOFFSET}%22%20alignment-baseline%3D%22before-edge%22%20dominant-baseline%3D%22text-before-edge%22%20text-anchor%3D%22middle%22%3E{CHARACTOR}%3C%2Ftspan%3E%3C%2Ftext%3E%3C%2Fdefs%3E%3Cg%3E%3Cg%3E%3Cg%3E%3Cuse%20xlink%3Ahref%3D%22%23e2iuzi5oh%22%20opacity%3D%221%22%20fill%3D%22%23{BGCOLOR}%22%20fill-opacity%3D%221%22%3E%3C%2Fuse%3E%3C%2Fg%3E%3Cg%20id%3D%22e2Qw0Jczps%22%3E%3Cuse%20xlink%3Ahref%3D%22%23d6VhEb28r%22%20opacity%3D%221%22%20fill%3D%22%23ffffff%22%20fill-opacity%3D%221%22%3E%3C%2Fuse%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%0D%0A";
		return tmp.replace("{XOFFSET}", "60").replace("{YOFFSET}", "65")
			.replace("{CHARACTOR}", charactor).replace("{BGCOLOR}", bgcolor);
	}

	// vehicle control
	var FORWARD_ICON = "data:image/png;base64,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";
	var FORWARD_PUSHED_ICON = "data:image/png;base64,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";
	var PROPO_ICON = "data:image/png;base64,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";
	var WAYPOINT_ICON = "data:image/svg+xml," + button_svg("W", "0000FF");
	var WAYPOINT2_ICON = "data:image/svg+xml," + button_svg("W", "000099");
	var HOME_ICON = "data:image/svg+xml," + button_svg("H", "0000FF");
	var HOME2_ICON = "data:image/svg+xml," + button_svg("H", "000099");
	var FOLLOW_ICON = "data:image/svg+xml," + button_svg("F", "0000FF");
	var FOLLOW2_ICON = "data:image/svg+xml," + button_svg("F", "000099");
	var MANUAL_ICON = "data:image/svg+xml," + button_svg("M", "0000FF");
	var MANUAL2_ICON = "data:image/svg+xml," + button_svg("M", "000099");
	var EMERGENCY_ICON = "data:image/svg+xml," + button_svg("E", "0000FF");
	var EMERGENCY2_ICON = "data:image/svg+xml," + button_svg("E", "000099");
	var STANBY_ICON = "data:image/svg+xml," + button_svg("S", "0000FF");
	var STANBY2_ICON = "data:image/svg+xml," + button_svg("S", "000099");
	// map
	var ALLOW_ICON = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAATCAMAAACTKxybAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAHJQTFRF//////8A//8A/6pV/79A/8wz/9Ur/9Eu/8Q7/8wz/9It/8k2/9Eu/8o1/9Av/8o1/84x/8wz/8wz/8wz/8wz/8wz/8s0/8wz/8s0/8wz/8wz/8wz/8wz/8s0/8wz/8wz/8wz/8wz/8wz/8wz/8wz/8wzo2lg3QAAACV0Uk5TAAECAwQFBgsNDxETFhgbHUNGm6Ckqa2usrW+w8fLztLV1tnc9jtYQ+sAAABdSURBVAjXZc9HDsAwCARAp/fee+X/X8wesIQVbiMELEqVU6B0VS8tocZARGvE8Edoi1leD+0Jy+2gI2U5LXRmLLuB7pxl1dBT6N4Fzf+OnJHb5B2ZwMhmpDb+kZ9+tBQLxwwvvoMAAAAASUVORK5CYII=";
	var VEHICLE_ICON = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAKEPAAChDwGlzVczAAAAB3RJTUUH4ggRBTEHEX876AAAAk5JREFUWMPFVztLHFEU/u44u4oKKyIWIvgDArFKWsFtRBsbu0hgcVKl0GJ/gX/B2t5GC1u7VAmsmiYPUmywCcFgdnEVZ+fxpZidnck6j3Oz4+bAgeHeO+f9nXMvICIqgFWAZwCZw2e9swrFEHcEStPYGkbxc4A2QD9DQQugm7Hv92Qs6yp/JfGQ5Kdmk54wGjWp8rcSgUrxnj1SSpySeiGeA+TxMX+HBuzu8rNGXaRFgs+kQsbG6HOAcmplkJNqgrZUwNIS3w0aMDPDjoYBdhLUxB4k0e0tv2sY4IcQVb2G4UvxUanAabVQAgDXBU0T/YZTLsN1HJgacDMMAKs6AD05wWX4vbKCH3t7kfEHB/A08b4KYXslQE5MRCH3vGjd96OiNM3MxpTQtjVaq2Xxa6hof59X4XqjwatwfWGBX3RkquBDRA4Z5J4EDQN/DZu4FKUxhgzpwfl59FU8PARKtrZwvrGBGwCw7Wi/UtGqBVmomk1eU0hHR/xWaAqmpuB2OlrwwvQ0cHdXUAq2tyPoxandxkXaP7Oz+FBICkoluklhLpd53jvjra/zhkycDwJI5hxYXOTPuNDDQ14YxuM7QKlENhr8FT87N8d7iQGZjajb5WXMaydP4OQkfTKI2ukp30saUTVrapF019bYloWzP665ucmPZD9NaVzVHkYFk2EAigDeAOAIFROABaj43Z02gPKIDOgCanywD7wcYQRepEWmNsQjRMqv89JTf0LldWmN1P6D54+MWBY8zSSXTzt45v07YqwhDNgpCrZP9jz/A+a1/TBqpiBgAAAAAElFTkSuQmCC";

	function toFixedFloat(value, c) {
		return parseFloat(value ? value.toFixed(c) : 0);
	}

	function decodeUtf8(data) {
		var result = "";
		var i = 0;
		var c = 0;
		var c1 = 0;
		var c2 = 0;
		// If we have a BOM skip it
		if (data.length >= 3 && data[0] === 0xef && data[1] === 0xbb
			&& data[2] === 0xbf) {
			i = 3;
		}
		while (i < data.length) {
			c = data[i];

			if (c < 128) {
				result += String.fromCharCode(c);
				i++;
			} else if (c > 191 && c < 224) {
				if (i + 1 >= data.length) {
					throw "UTF-8 Decode failed. Two byte character was truncated.";
				}
				c2 = data[i + 1];
				result += String.fromCharCode(((c & 31) << 6) | (c2 & 63));
				i += 2;
			} else {
				if (i + 2 >= data.length) {
					throw "UTF-8 Decode failed. Multi byte character was truncated.";
				}
				c2 = data[i + 1];
				c3 = data[i + 2];
				result += String.fromCharCode(((c & 15) << 12)
					| ((c2 & 63) << 6) | (c3 & 63));
				i += 3;
			}
		}
		return result;
	}

	function create_button(src_normal, src_pushed, callback) {
		var button = document.createElement("img");
		button.src = src_normal;
		button.src_normal = src_normal;
		button.src_pushed = src_pushed;
		button.down = false;
		button.set_src = function(src_normal, src_pushed) {
			button.src_normal = src_normal;
			button.src_pushed = src_pushed;
			button.src = (!button.down ? src_normal : src_pushed);
		}

		var st = 0, et = 0;
		var sx = 0, sy = 0;
		var x_axis = 0;// -1:1
		var x_axis_candidate = 0;
		var y_axis = 0;// -1:1
		var y_axis_candidate = 0;
		var mousedownFunc = function(ev) {
			if (callback) {
				callback({
					type : "down"
				});
			}

			if (ev.type == "touchstart") {
				ev.clientX = ev.pageX;
				ev.clientY = ev.pageY;
			}
			st = Date.now();
			sx = ev.clientX;
			sy = ev.clientY;
			x_axis = 0;
			y_axis = 0;
			x_axis_candidate = 0;
			y_axis_candidate = 0;

			button.down = true;
			if (button.src_pushed) {
				button.src = button.src_pushed;
			}
		}
		button.mouseupFunc = function() {
			et = Date.now();
			if (callback) {
				callback({
					type : "up",
					elapsed_ms : et - st
				});
			}

			button.down = false;
			button.src = button.src_normal;

			x_axis = 0;
			y_axis = 0;
			x_axis_candidate = 0;
			y_axis_candidate = 0;
		}
		button.mousemoveFunc = function(ev) {
			if (ev.type == "touchmove") {
				ev.clientX = ev.pageX;
				ev.clientY = ev.pageY;
				ev.button = 0;
			}
			if (!button.down || ev.button != 0) {
				return;
			}
			var dx = (ev.clientX - sx);
			var dy = (ev.clientY - sy);

			var threshold = 1;
			dx = parseInt(dx / threshold) * threshold;
			dy = parseInt(dy / threshold) * threshold;
			sx += dx;
			sy += dy;

			var limit = window.parent.screen.width / 20;
			if (dx == 0) {
				// do nothing
			} else {
				x_axis_candidate += dx / limit;
				x_axis_candidate = Math.max(-1, Math.min(x_axis_candidate, 1));
			}
			if (dy == 0) {
				// do nothing
			} else {
				y_axis_candidate -= dy / limit;// minus means system coodinate
				// to
				y_axis_candidate = Math.max(-1, Math.min(y_axis_candidate, 1));
			}
			ev.preventDefault();
			ev.stopPropagation();
		}
		var preventFunc = function(ev) {
			ev.preventDefault();
			ev.stopPropagation();
		}
		button.addEventListener("touchstart", mousedownFunc);
		button.addEventListener("mousedown", mousedownFunc);
		button.addEventListener("dragstart", preventFunc, {
			passive : false
		});

		setInterval(function() {
			var updated = false;
			var ev = {
				type : "axis",
				x : x_axis,
				dx : 0,
				y : y_axis,
				dy : 0,
			};
			if (x_axis_candidate != x_axis) {
				ev.x = x_axis_candidate;
				ev.dx = x_axis_candidate - x_axis;

				x_axis = x_axis_candidate;
				updated = true;
			}
			if (y_axis_candidate != y_axis) {
				ev.y = y_axis_candidate;
				ev.dy = y_axis_candidate - y_axis;

				y_axis = y_axis_candidate;
				updated = true;
			}
			if (updated && callback) {
				callback(ev);
			}
		}, 200);

		button.style.position = 'absolute';
		button.style.display = "none";
		button.width = 50;
		button.height = 50;

		var mouseupFunc = function(ev) {
			if (button.down) {
				button.mouseupFunc(ev);
			}
		}
		var mousemoveFunc = function(ev) {
			if (button.down) {
				button.mousemoveFunc(ev);
			}
		}

		// addEventListener spec migration
		var supportsPassive = false;
		try {
			var opts = Object.defineProperty({}, 'passive', {
				get : function() {
					supportsPassive = true;
				}
			});
			window.addEventListener("test", null, opts);
		} catch (e) {
		}
		document.addEventListener("touchend", mouseupFunc);
		document.addEventListener("mouseup", mouseupFunc);
		document.addEventListener("touchmove", mousemoveFunc, supportsPassive
			? {
				passive : false,
				capture : true
			}
			: true);
		document.addEventListener("mousemove", mousemoveFunc, supportsPassive
			? {
				passive : false,
				capture : true
			}
			: true);

		return button;
	}

	function get_waypoints(callback) {
		m_get_waypoints_callback = function(v) {
			callback(v);
			m_get_waypoints_callback = null;
		}
		m_plugin_host.send_command(SERVICE_DOMAIN + "get_waypoints");
	}
	function get_history(callback) {
		m_get_history_callback = function(v) {
			callback(v);
			m_get_history_callback = null;
		}
		m_plugin_host.send_command(SERVICE_DOMAIN + "get_history");
	}
	function init(plugin, options) {
		console.log(plugin.name + "::init()");

		m_foward_button = create_button(FORWARD_ICON, FORWARD_PUSHED_ICON, function(
			e) {
			switch (e.type) {
				case "axis" :
					if(m_status.manual_pid_enabled){
						plugin.event_handler_act("SET_THRUSTER "
							+ Math.ceil(e.y * 100) + " " + Math.ceil(e.dx * 100));
					}else{
						plugin.event_handler_act("SET_THRUSTER "
							+ Math.ceil(e.y * 100) + " " + Math.ceil(e.x * 100));
					}
					break;
				case "up" :
					plugin.event_handler_act("SET_THRUSTER 0 0");
					break;
			}
		});
		m_foward_button
			.setAttribute("style", "position:absolute; bottom:33%; right:10%;");

		m_operation_mode_button = create_button(STANBY_ICON, STANBY2_ICON, function(
			e) {
			switch (e.type) {
				case "axis" :
					switch (m_status.operation_mode) {
						case "MANUAL" :
							if (e.x <= -1.0) {
								m_operation_mode_button.next_mode = "FOLLOW";
							} else if (e.y <= -1.0) {
								m_operation_mode_button.next_mode = "HOME";
							} else if (e.y >= 1.0) {
								m_operation_mode_button.next_mode = "WAYPOINT";
							} else if (e.x >= 1.0) {
								m_operation_mode_button.next_mode = "EMERGENCY";
							} else {
								m_operation_mode_button.next_mode = undefined;
							}
							break;
						default :
							break;
					}
					break;
				case "up" : {
					if (m_operation_mode_button.next_mode) {
						plugin.event_handler_act("CHANGE_"
							+ m_operation_mode_button.next_mode);
						m_operation_mode_button.next_mode = undefined;
					} else if (e.elapsed_ms > 1000) {
						if (m_status.operation_mode == "STANBY") {
							plugin.event_handler_act("CHANGE_MANUAL");
						} else {
							plugin.event_handler_act("CHANGE_STANBY");
						}
					} else {
						switch (m_status.operation_mode) {
							case "WAYPOINT" :
							case "HOME" :
							case "FOLLOW" :
								plugin.event_handler_act("CHANGE_MANUAL");
								break;
							case "MANUAL" :
							case "EMERGENCY" :
								break;
							case "STANBY" :
							default :
								plugin.event_handler_act("CHANGE_STANBY");
								break;
						}
					}
					break;
				}
			}
		});
		m_operation_mode_button
			.setAttribute("style", "position:absolute; bottom:66%; right:10%;");

		document.body.appendChild(m_foward_button);
		document.body.appendChild(m_operation_mode_button);

		function refresh_button() {
			if (m_map_mode) {
				m_operation_mode_button.style.display = "none";
				m_foward_button.style.display = "none";
			} else {
				switch (m_status.operation_mode) {
					case "WAYPOINT" :
						m_operation_mode_button
							.set_src(WAYPOINT_ICON, WAYPOINT2_ICON);
						m_foward_button.style.display = "none";
						m_operation_mode_button.style.display = "block";
						break;
					case "HOME" :
						m_operation_mode_button.set_src(HOME_ICON, HOME2_ICON);
						m_foward_button.style.display = "none";
						m_operation_mode_button.style.display = "block";
						break;
					case "FOLLOW" :
						m_operation_mode_button
							.set_src(FOLLOW_ICON, FOLLOW2_ICON);
						m_foward_button.style.display = "none";
						m_operation_mode_button.style.display = "block";
						break;
					case "MANUAL" :
						m_operation_mode_button
							.set_src(MANUAL_ICON, MANUAL2_ICON);
						m_foward_button.style.display = "block";
						m_operation_mode_button.style.display = "block";
						break;
					case "EMERGENCY" :
						m_operation_mode_button
							.set_src(EMERGENCY_ICON, EMERGENCY2_ICON);
						m_foward_button.style.display = "block";
						m_operation_mode_button.style.display = "block";
						break;
					case "STANBY" :
					default :
						m_operation_mode_button
							.set_src(STANBY_ICON, STANBY2_ICON);
						m_foward_button.style.display = "none";
						m_operation_mode_button.style.display = "block";
						break;
				}
			}
		}

		function get_bat_per(bat) {
			var bat_min_v = options["bat_min_v"] || 9.6;
			var bat_max_v = options["bat_max_v"] || 12.6;
			var bat_per = (bat - bat_min_v) / (bat_max_v - bat_min_v);
			return Math.max(0, Math.min(bat_per * 100, 100));
		}
		setInterval(function() {
			// operator position
			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(function(position) {
					m_operator_pos = {
						lon : position.coords.longitude,
						lat : position.coords.latitude,
					};
					if (m_status.operation_mode == "FOLLOW") {
						var cmd = SERVICE_DOMAIN + "set_operator_position "
							+ m_operator_pos.lon + " " + m_operator_pos.lat
							+ " 10";
						m_plugin_host.send_command(cmd);
					}
				}, function(error) {
					m_operator_pos = null;
				}, {
					"enableHighAccuracy" : false,
					"timeout" : 8000,
					"maximumAge" : 2000,
				});
			} else {
				m_operator_pos = null;
			}
		}, 1000);

		var map_plugin = m_plugin_host.get_plugin("map");
		map_plugin
			.set_post_map_loaded(function(map) {
				m_map_mode = true;

				// menu
				app.menu.setMenuPage("wp_menu.html", {
					callback : function() {
					}
				});
				// button
				refresh_button();
				// layers
				if (m_status.lon && m_status.lat) {
					map.getView().setCenter(ol.proj.fromLonLat([m_status.lon,
						m_status.lat]));
					map.getView().setZoom(15);
				}
				// waypoints
				var featureWaypoints = new ol.Feature();
				// history
				var featureHistory = new ol.Feature();
				// history current
				var featureHistoryCurrent = new ol.Feature();
				// gps_point
				var featureGpsPoint = new ol.Feature();
				// operator_point
				var featureOperatorPoint = new ol.Feature();
				// home_point
				var featureHomePoint = new ol.Feature();
				// target
				var featureTarget = new ol.Feature();

				var layerWaypoints = new ol.layer.Vector({
					source : new ol.source.Vector({
						features : [featureWaypoints]
					}),
					style : function(feature) {
						var geometry = feature.getGeometry();
						var styles = [
						// linestring
						new ol.style.Style({
							stroke : new ol.style.Stroke({
								color : '#ffcc33',
								width : 2
							})
						})];

						geometry.forEachSegment(function(start, end) {
							var dx = end[0] - start[0];
							var dy = end[1] - start[1];
							var rotation = Math.atan2(dy, dx);
							// arrows
							styles.push(new ol.style.Style({
								geometry : new ol.geom.Point(end),
								image : new ol.style.Icon({
									src : ALLOW_ICON,
									anchor : [0.75, 0.5],
									rotateWithView : false,
									rotation : -rotation
								})
							}));
						});

						return styles;
					}
				});
				map.addLayer(layerWaypoints);
				var layerHistory = new ol.layer.Vector({
					source : new ol.source.Vector({
						features : [featureHistory]
					})
				});
				map.addLayer(layerHistory);

				map.addLayer(new ol.layer.Vector({
					source : new ol.source.Vector({
						features : [featureTarget, featureHistoryCurrent]
					})
				}));

				var layerHistoryPoints = new ol.layer.Vector({
					source : new ol.source.Vector({
						features : []
					}),
					style : function(feature) {
						var timestamp = feature.get('timestamp');
						var node = m_history[timestamp];
						var styles = [new ol.style.Style({
							image : new ol.style.Circle({
								radius : 5,
								stroke : new ol.style.Stroke({
									color : [255 * get_bat_per(node.bat) / 100,
										0, 0],
									width : 2
								})
							})
						})];

						return styles;
					}
				});
				map.addLayer(layerHistoryPoints);

				var layerWaypointsPoints = new ol.layer.Vector({
					source : new ol.source.Vector({
						features : []
					}),
					style : function(feature) {
						var idx = feature.get('idx');
						var tol = m_waypoints[idx].tol || 30;
						var radius = map.getPixelFromCoordinate([tol, 0])[0]
							- map.getPixelFromCoordinate([0, 0])[0];
						var color = [0, 255, 0];
						if (m_waypoints[idx].act) {
							switch (m_waypoints[idx].act.fnc) {
								case "wait" :
									color = [255, 0, 0];
									break;
								case "sampling" :
									color = [255, 255, 0];
									break;
								case "snap" :
									color = [0, 0, 255];
									break;
								default : // err
									color = [0, 0, 0];
									break;
							}
						}
						var styles = [new ol.style.Style({
							image : new ol.style.Circle({
								radius : radius,
								stroke : new ol.style.Stroke({
									color : color,
									width : 2
								})
							})
						})];

						return styles;
					}
				});
				map.addLayer(layerWaypointsPoints);

				var layerGpsPoint = new ol.layer.Vector({
					source : new ol.source.Vector({
						features : [featureGpsPoint, featureOperatorPoint, featureHomePoint]
					})
				});
				map.addLayer(layerGpsPoint);

				// current position
				setInterval(function() {
					// operator position
					if (m_operator_pos) {
						var heading = -m_plugin_host.get_view_north();
						var gps_point_obj = new ol.geom.Point(ol.proj
							.fromLonLat([m_operator_pos.lon, m_operator_pos.lat]));
						featureOperatorPoint.setGeometry(gps_point_obj);
						featureOperatorPoint.setStyle([
							new ol.style.Style({
								image : new ol.style.Icon({
									opacity : 1.0,
									src : VEHICLE_ICON,
									anchor : [0.5, 0.5],
									rotateWithView : false,
									rotation : Math.PI * heading / 180
										+ map.getView().getRotation()
								})
							}), new ol.style.Style({
								image : new ol.style.Circle({
									radius : 15,
									stroke : new ol.style.Stroke({
										color : [255, 255, 255],
										width : 2
									})
								})
							})]);
					}
					//home
					if (m_status.home) {
						var tol = m_status.home.tol || 30;
						var radius = map.getPixelFromCoordinate([tol, 0])[0]
							- map.getPixelFromCoordinate([0, 0])[0];
						var gps_point_obj = new ol.geom.Point(ol.proj
							.fromLonLat([m_status.home.lon, m_status.home.lat]));
						featureOperatorPoint.setGeometry(gps_point_obj);
						featureOperatorPoint.setStyle([
							new ol.style.Style({
								image : new ol.style.Icon({
									opacity : 1.0,
									src : HOME_ICON,
									anchor : [0.5, 0.5],
									rotateWithView : false,
									rotation : 0
								})
							}), new ol.style.Style({
								image : new ol.style.Circle({
									radius : radius,
									stroke : new ol.style.Stroke({
										color : [0, 255, 0],
										width : 2
									})
								})
							})]);
					}
					// vehicle position
					if (m_status.lon && m_status.lat) {
						var gps_point_obj = new ol.geom.Point(ol.proj
							.fromLonLat([m_status.lon, m_status.lat]));
						featureGpsPoint.setGeometry(gps_point_obj);
						featureGpsPoint
							.setStyle([
								new ol.style.Style({
									image : new ol.style.Icon({
										opacity : m_status.gps ? 1.0 : 0.5,
										src : VEHICLE_ICON,
										anchor : [0.5, 0.5],
										rotateWithView : false,
										rotation : m_status.heading ? Math.PI
											* m_status.heading / 180
											+ map.getView().getRotation() : 0
									})
								}),
								new ol.style.Style({
									image : new ol.style.Circle({
										radius : 15,
										stroke : new ol.style.Stroke({
											color : [
												255 * get_bat_per(m_status.bat) / 100,
												0, 0],
											width : 2
										})
									})
								})]);
					}
					if (m_status.lon && m_status.lat) {
						if (m_waypoints[m_status.next_waypoint_idx]) {
							var gps_point = ol.proj.fromLonLat([m_status.lon,
								m_status.lat]);
							var target_point = ol.proj.fromLonLat([
								m_waypoints[m_status.next_waypoint_idx].lon,
								m_waypoints[m_status.next_waypoint_idx].lat]);
							featureTarget.setGeometry(new ol.geom.LineString([
								gps_point, target_point]));
							featureTarget.setStyle(new ol.style.Style({
								stroke : new ol.style.Stroke({
									width : 5,
									color : '#ffcc33',
									lineDash : [10, 10]
								})
							}));
						}
						var keys = Object.keys(m_history);
						keys.sort(function(a, b) {
							return parseInt(b) - parseInt(a);
						});
						for (var i = 0; i < keys.length; i++) {
							if (m_history[keys[i]].lon
								&& m_history[keys[i]].lat) {
								var pos = ol.proj.fromLonLat([
									m_history[keys[i]].lon,
									m_history[keys[i]].lat]);
								var gps_point = ol.proj.fromLonLat([
									m_status.lon, m_status.lat]);
								featureHistoryCurrent
									.setGeometry(new ol.geom.LineString([
										gps_point, pos]));
								break;
							}
						}
					}
				}, 1000);

				function new_node(pos) {
					var node = {
						lat : pos.lat,
						lon : pos.lon,
						tol : options["default_tol"] || 30
					};
					if (options.act_presets["default"]) {
						node.act = options.act_presets["default"];
					}
					return node;
				}

				// event handle
				var dragInteraction = new ol.interaction.Modify({
					features : new ol.Collection([featureWaypoints]),
					style : null,
					pixelTolerance : 20
				});
				dragInteraction.on('modifyend', function() {
					var ary = featureWaypoints.getGeometry().getCoordinates();
					for (var i = 0; i < ary.length - 1; i++) {
						var lonlat = ol.proj
							.transform(ary[i], 'EPSG:3857', 'EPSG:4326');
						var pos = {
							lat : toFixedFloat(lonlat[1], 6),
							lon : toFixedFloat(lonlat[0], 6)
						}
						if (i < m_waypoints.length // last
							&& m_waypoints[i].lon == pos.lon
							&& m_waypoints[i].lat == pos.lat) {
						} else {
							if (m_waypoints.length == ary.length - 1) {// modified
								m_waypoints[i].lon = pos.lon;
								m_waypoints[i].lat = pos.lat;
							} else {// split, add
								m_waypoints.splice(i, 0, new_node(pos));
							}
							break;
						}
					}
					var cmd = SERVICE_DOMAIN + "set_waypoints "
						+ encodeURIComponent(JSON.stringify(m_waypoints));
					m_plugin_host.send_command(cmd);
					refresh_waypoints(m_waypoints);
				});
				function edit_waypoint(wp, ext, callback) {
					var _wp = Object.assign({}, wp);
					app.navi
						.pushPage('edit_waypoint.html', {
							onTransitionEnd : function() {
								var act_types = ["none", "wait", "sampling",
									"snap"];
								function get_parts(type, name) {
									return $('#edit_waypoint_form ' + type
										+ '[name="' + name + '"]');
								}
								if (ext.next_waypoint) {
									get_parts("input", "next_waypoint")
										.prop("checked", true);
									get_parts("input", "next_waypoint")
										.prop('disabled', true);
								}
								get_parts("input", "lat").val(_wp.lat);
								get_parts("input", "lon").val(_wp.lon);
								get_parts("input", "tol").val(_wp.tol);
								for (var i = 0; i < act_types.length; i++) {
									get_parts("select", "fnc")
										.append($('<option>').val(act_types[i])
											.text(act_types[i]));
								}
								if (options.act_presets) {
									var keys = Object.keys(options.act_presets);
									for (var i = 0; i < keys.length; i++) {
										get_parts("select", "fnc")
											.append($('<option>').val("preset:"
												+ keys[i]).text("preset:"
												+ keys[i]));
									}
								}
								function on_fnc_select_change() {
									var prm = (_wp.act && _wp.act.prm) || {};
									var fnc = get_parts("select", "fnc").val()
										.split(":");
									var fnc_form = $('#edit_waypoint_fnc_prm_form');
									switch (fnc[0]) {
										case "wait" :
											fnc_form.empty();
											fnc_form
												.append('value:<input type="text" name="val" value="'
													+ (prm.val || 0) + '"/>');
											break;
										case "sampling" :
											fnc_form.empty();
											fnc_form
												.append('channel:<input type="number" name="ch" value="'
													+ (prm.ch || 0)
													+ '" /><br />');
											fnc_form
												.append('count:<input type="number" name="cnt" value="'
													+ (prm.cnt || 10)
													+ '" /><br />');
											fnc_form
												.append('topic:<input type="text" name="tpc" value="'
													+ (prm.tpc || "")
													+ '" /><br />');
											break;
										case "snap" :
											fnc_form.empty();
											fnc_form
												.append('topic:<input type="text" name="tpc" value="'
													+ (prm.tpc || "")
													+ '" /><br />');
											break;
										case "preset" :
											_wp.act = options.act_presets[fnc[1]];
											get_parts("select", "fnc")
												.val((_wp.act && _wp.act.fnc)
													|| "none");
											on_fnc_select_change();
											break;
										case "none" :
										default :
											fnc_form.empty();
											break;
									}
								}
								get_parts("select", "fnc")
									.change(on_fnc_select_change);
								get_parts("select", "fnc")
									.val((_wp.act && _wp.act.fnc) || "none");
								on_fnc_select_change();
								get_parts("input", "apply")
									.on('click', function() {
										var _ext = {
											next_waypoint : get_parts("input", "next_waypoint")
												.prop("checked")
										};
										_wp.lat = parseFloat(get_parts("input", "lat")
											.val());
										_wp.lon = parseFloat(get_parts("input", "lon")
											.val());
										_wp.tol = parseFloat(get_parts("input", "tol")
											.val());
										var fnc = get_parts("select", "fnc")
											.val();
										if (fnc == "none") {
											delete _wp.act;
										} else {
											_wp.act = {
												fnc : fnc
											};
										}
										function get_fnc_prm_parts(type, name) {
											return $('#edit_waypoint_fnc_prm_form '
												+ type
												+ '[name="'
												+ name
												+ '"]');
										}
										switch (fnc) {
											case "wait" :
												var prm = {};
												prm.val = get_fnc_prm_parts("input", "val")
													.val();
												_wp.act = {
													fnc : fnc,
													prm : prm,
												};
												break;
											case "sampling" :
												var prm = {};
												prm.ch = parseFloat(get_fnc_prm_parts("input", "ch")
													.val());
												prm.cnt = parseFloat(get_fnc_prm_parts("input", "cnt")
													.val());
												prm.tpc = get_fnc_prm_parts("input", "tpc")
													.val();
												_wp.act = {
													fnc : fnc,
													prm : prm,
												};
												break;
											case "snap" :
												var prm = {};
												prm.tpc = get_fnc_prm_parts("input", "tpc")
													.val();
												_wp.act = {
													fnc : fnc,
													prm : prm,
												};
												break;
											case "none" :
											default :
												delete _wp.act;
												break;
										}
										callback(_wp, _ext);
										app.navi.popPage();
									});
							}
						});
				}
				function click(evt) {
					var coordinate = evt.coordinate;
					var stringifyFunc = ol.coordinate.createStringXY(9);
					var outstr = stringifyFunc(ol.proj
						.transform(coordinate, "EPSG:3857", "EPSG:4326"));
					console.log(outstr);
					var waypoint_features = map.getFeaturesAtPixel(evt.pixel, {
						layerFilter : function(layer) {
							return layer == layerWaypointsPoints;
						}
					});
					var history_features = map.getFeaturesAtPixel(evt.pixel, {
						layerFilter : function(layer) {
							return layer == layerHistoryPoints;
						}
					});
					var gpspoint_features = map.getFeaturesAtPixel(evt.pixel, {
						layerFilter : function(layer) {
							return layer == layerGpsPoint;
						}
					});
					if (gpspoint_features) {
						if (m_wp_mode == "CHECK") {
							var pos = gpspoint_features[0].getGeometry()
								.getCoordinates();
							var timer;
							var popup_update = function() {
								var timestr = new Date(parseInt(m_status.timestamp) * 1000)
									.toLocaleString();
								var msg = "";
								msg += timestr + "<br/>";
								msg += m_status.lat + "," + m_status.lon
									+ "<br/>";
								msg += "spd:" + m_status.spd + "km/h" + "<br/>";
								msg += "bat:" + m_status.bat + "V" + "<br/>";
								msg += "bamp:" + m_status.bamp + "A" + "<br/>";
								msg += "samp:" + m_status.samp + "A" + "<br/>";
								msg += "thr:" + m_status.thruster + "us"
									+ "<br/>";
								msg += "rud:" + m_status.rudder + "us";
								map_plugin.set_popup_msg(msg);
								timer = setTimeout(popup_update, 500);
							};
							map_plugin.popup(pos, "", function() {
								clearTimeout(timer);
							});
							popup_update();
						}
					} else if (waypoint_features) {
						var idx = waypoint_features[0].get('idx');
						var ext = {
							next_waypoint : m_status.next_waypoint_idx == idx
						};
						if (m_wp_mode == "EDIT") { // edit
							edit_waypoint(m_waypoints[idx], ext, function(wp,
								_ext) {
								m_waypoints[idx] = wp;
								var cmd = SERVICE_DOMAIN
									+ "set_waypoints "
									+ encodeURIComponent(JSON
										.stringify(m_waypoints));
								m_plugin_host.send_command(cmd);
								refresh_waypoints(m_waypoints);
								if (!ext.next_waypoint && _ext.next_waypoint) {
									var cmd = SERVICE_DOMAIN
										+ "set_next_waypoint_idx " + idx;
									m_plugin_host.send_command(cmd);
								}
							});
						} else if (m_wp_mode == "CHECK") {
							var pos = waypoint_features[0].getGeometry()
								.getCoordinates();
							var node = m_waypoints[idx];
							var msg = node.lat + "," + node.lon + "<br/>";
							map_plugin.popup(pos, msg);
						}
					} else if (history_features) {
						if (m_wp_mode == "CHECK") {
							var pos = history_features[0].getGeometry()
								.getCoordinates();
							var timestamp = history_features[0]
								.get('timestamp');
							var node = m_history[timestamp];
							var timestr = new Date(parseInt(timestamp) * 1000)
								.toLocaleString();
							var msg = timestr + "<br/>" + node.lat + ","
								+ node.lon + "<br/>" + node.bat + "V";
							map_plugin.popup(pos, msg);
						}
					}
				}
				function dblclick(evt) {
					var coordinate = evt.coordinate;
					var stringifyFunc = ol.coordinate.createStringXY(9);
					var outstr = stringifyFunc(ol.proj
						.transform(coordinate, "EPSG:3857", "EPSG:4326"));
					console.log(outstr);
					var waypoint_features = map.getFeaturesAtPixel(evt.pixel, {
						layerFilter : function(layer) {
							return layer == layerWaypointsPoints;
						}
					});
					var history_features = map.getFeaturesAtPixel(evt.pixel, {
						layerFilter : function(layer) {
							return layer == layerHistoryPoints;
						}
					});
					if (waypoint_features) {
						if (m_wp_mode == "EDIT") {// remove
							var idx = waypoint_features[0].get('idx');
							m_waypoints.splice(idx, 1);
							var cmd = SERVICE_DOMAIN
								+ "set_waypoints "
								+ encodeURIComponent(JSON
									.stringify(m_waypoints));
							m_plugin_host.send_command(cmd);
							refresh_waypoints(m_waypoints);
						}
					} else if (history_features) {
						// do nothing
					} else if (m_wp_mode == "EDIT") {// add
						var lonlat = ol.proj
							.transform(coordinate, "EPSG:3857", "EPSG:4326");
						m_waypoints.push(new_node({
							lat : toFixedFloat(lonlat[1], 6),
							lon : toFixedFloat(lonlat[0], 6)
						}));
						var cmd = SERVICE_DOMAIN + "set_waypoints "
							+ encodeURIComponent(JSON.stringify(m_waypoints));
						m_plugin_host.send_command(cmd);
						refresh_waypoints(m_waypoints);
					}
				}
				var is_click = false;
				var is_dblclick = false;
				map.on('click', function(evt) {
					if (!is_dblclick) {
						is_click = true;
						setTimeout(function() {
							if (is_click) {
								is_click = false;
								click(evt);
								console.log("click");
							}
						}, 500);
					}
				});
				map.on('dblclick', function(evt) {
					is_dblclick = true;
					is_click = false;
					setTimeout(function() {
						is_dblclick = false;
						dblclick(evt);
						console.log("dblclick");
					}, 500);
					evt.preventDefault();
					evt.stopPropagation();
				});

				// set mode
				set_wp_mode = function(mode) {
					m_wp_mode = mode;
					console.log("set_wp_mode:" + m_wp_mode);
					switch (m_wp_mode) {
						case "EDIT" :
							map.addInteraction(dragInteraction);
							break;
						case "CHECK" :
							map.removeInteraction(dragInteraction);
							break;
					}
				};
				m_wp_mode = "CHECK";

				function refresh_waypoints(waypoints) {
					var features = [];
					var points = [];
					for (var i = 0; i < waypoints.length; i++) {
						points.push(ol.proj.fromLonLat([waypoints[i].lon,
							waypoints[i].lat]));
						var feature = new ol.Feature(new ol.geom.Point(ol.proj
							.fromLonLat([waypoints[i].lon, waypoints[i].lat])));
						feature.set('idx', i);
						features.push(feature);
					}
					if (waypoints.length >= 2) {
						points.push(ol.proj.fromLonLat([waypoints[0].lon,
							waypoints[0].lat]));
					}
					featureWaypoints
						.setGeometry(new ol.geom.LineString(points));
					layerWaypointsPoints.setSource(new ol.source.Vector({
						features : features
					}));
				}

				// request additional infomation
				var request_waypoints = function() {
					get_waypoints(function(waypoints) {
						refresh_waypoints(waypoints);
					});

					setTimeout(request_waypoints, 60 * 1000);
				}
				request_waypoints();

				var request_history = function() {
					get_history(function(history) {
						var features = [];
						var points = [];
						var keys = Object.keys(history);
						keys.sort(function(a, b) {
							return parseInt(b) - parseInt(a);
						});
						for (var i = 0; i < keys.length; i++) {
							if (history[keys[i]].lon && history[keys[i]].lat) {
								points.push(ol.proj
									.fromLonLat([history[keys[i]].lon,
										history[keys[i]].lat]));
								var feature = new ol.Feature(new ol.geom.Point(ol.proj
									.fromLonLat([history[keys[i]].lon,
										history[keys[i]].lat])));
								feature.set('timestamp', keys[i]);
								features.push(feature);
							}
						}
						featureHistory
							.setGeometry(new ol.geom.LineString(points));
						layerHistoryPoints.setSource(new ol.source.Vector({
							features : features
						}));
					});

					setTimeout(request_history, 60 * 1000);
				}
				request_history();
			});// set_post_map_loaded
		map_plugin.set_post_map_unloaded(function() {
			m_map_mode = false;
			// menu
			m_plugin_host.restore_app_menu();
			// button
			refresh_button();
		});// set_post_map_unloaded
		m_plugin_host
			.getFile("plugins/jetusv/wp_menu.html", function(chunk_array) {
				var txt = decodeUtf8(chunk_array[0])
					.replace(/%PLUGIN_NAME%/g, PLUGIN_NAME);
				var node = $.parseHTML(txt);
				$('body').append(node);
				ons.compile(node[0]);
			});
		m_plugin_host.getFile("plugins/jetusv/edit_waypoint.html", function(
			chunk_array) {
			var txt = decodeUtf8(chunk_array[0]);
			var node = $.parseHTML(txt);
			$('body').append(node);
			ons.compile(node[0]);
		});
		window.jetusv_on_set_param_done_callback = (msg) => {
			if(msg.startsWith('["jetusv",')){
				var params = JSON.parse(msg);
				m_status = JSON.parse(atob(params[2]));
				m_status.timestamp = parseInt(Date.now() / 1000);
				if (m_status.waypoints && m_get_waypoints_callback) {
					m_waypoints = m_status.waypoints;
					m_get_waypoints_callback(m_waypoints);
				}
				if (m_status.history && m_get_history_callback) {
					m_history = m_status.history;
					m_get_history_callback(m_history);
				}
				refresh_button();
			}
		};
	}// init
	return function(plugin_host) {
		m_plugin_host = plugin_host;
		var step = 5;
		var interval = 50;
		var timer;
		var timer_key;
		var menu_visible = false;
		var stereo_enabled = false;
		var plugin = {
			name : PLUGIN_NAME,
			pst_params : {},
			init_options : function(options) {
				if (!m_is_init) {
					m_is_init = true;
					var jetusv_options = options.jetusv;
					if(!jetusv_options){
						jetusv_options = {
							bat_min_v : 9.6,
							bat_max_v : 12.7,
							default_tol : 30,
							act_presets : {
								default : {
								},
							},
						};
					}
					init(plugin, jetusv_options);
				}
			},
			pst_started : function(pstcore, pst) {
				this.pst_params[pst] = {};
				pstcore.pstcore_add_set_param_done_callback(pst, "jetusv_on_set_param_done_callback");
			},
			pst_stopped : function(pstcore, pst) {
				delete this.pst_params[pst];
				pstcore.pstcore_remove_set_param_done_callback(pst, "connect_on_set_param_done_callback");
			},
			command_handler : function(cmd) {
			},
			event_handler : function(sender, event) {
				if (sender == "PLUGIN_HOST") {
					switch (event) {
						case "STEREO_ENABLED" :
							m_foward_button.style.display = "none";
							m_operation_mode_button.style.display = "none";
							break;
						case "STEREO_DISABLED" :
							m_foward_button.style.display = "block";
							m_operation_mode_button.style.display = "block";
							break;
					}
					return;
				} else if (sender == "ICADE") {
					switch (event) {
						case "B_BUTTON_UP" :
							event = "STEREO_ENABLED";
							break;
						case "G_BUTTON_DOWN" :
							event = "MOVE";
							break;
						case "G_BUTTON_UP" :
							event = "STOP"
							break;
						case "A_BUTTON_UP" :
							event = "MENU_VISIBLE";
							break;
						case "LEFT_BUTTON_DOWN" :
						case "RIGHT_BUTTON_DOWN" :
						case "UP_BUTTON_DOWN" :
						case "DOWN_BUTTON_DOWN" :
							if (menu_visible) {
							} else {
							}
							return;
						case "RIGHT_BUTTON_UP" :
							if (menu_visible) {
								event = "SELECT_ACTIVE_MENU";
							} else if (timer_key == "RIGHT_BUTTON_DOWN") {
							}
							break;
						case "LEFT_BUTTON_UP" :
							if (menu_visible) {
								event = "DESELECT_ACTIVE_MENU";
							} else if (timer_key == "LEFT_BUTTON_DOWN") {
							}
							break;
						case "UP_BUTTON_UP" :
							if (menu_visible) {
								event = "BACK2PREVIOUSE_MENU";
							} else if (timer_key == "UP_BUTTON_DOWN") {
							}
							break;
						case "DOWN_BUTTON_UP" :
							if (menu_visible) {
								event = "GO2NEXT_MENU";
							} else if (timer_key == "DOWN_BUTTON_DOWN") {
							}
							break;
					}
				} else if (sender == "GAMEPAD") {
					console.log(event);
					switch (event) {
						case "0_BUTTON_UP" :
							event = "PID_ENABLED";
							break;
						case "1_BUTTON_UP" :
							event = "STEREO_ENABLED";
							break;
						case "4_BUTTON_UP" :
							event = "MENU_VISIBLE";
							break;
						case "4_AXIS_FORWARD_UP" :
							if (menu_visible) {
								event = "SELECT_ACTIVE_MENU";
							}
							break;
						case "4_AXIS_BACKWARD_UP" :
							if (menu_visible) {
								event = "DESELECT_ACTIVE_MENU";
							}
							break;
						case "5_AXIS_FORWARD_UP" :
							if (menu_visible) {
								event = "BACK2PREVIOUSE_MENU";
							} else {
								event = "INCREMENT_PITCH";
							}
							break;
						case "5_AXIS_BACKWARD_UP" :
							if (menu_visible) {
								event = "GO2NEXT_MENU";
							} else {
								event = "DECREMENT_PITCH";
							}
							break;
					}
				}
				plugin.event_handler_act(event);
			},
			event_handler_act : function(event) {
				var params = event.split(" ");
				switch (params[0]) {
					case "MOVE" :
						break;
					case "STOP" :
						break;
					case "STEREO_ENABLED" :
						stereo_enabled = !stereo_enabled;
						m_plugin_host.send_command("set_stereo "
							+ (stereo_enabled ? "1" : "0"));
						break;
					case "MENU_VISIBLE" :
						menu_visible = !menu_visible;
						m_plugin_host.set_menu_visible(menu_visible);
						break;
					case "SELECT_ACTIVE_MENU" :
						m_plugin_host.send_command(SYSTEM_DOMAIN
							+ "select_active_menu");
						break;
					case "DESELECT_ACTIVE_MENU" :
						m_plugin_host.send_command(SYSTEM_DOMAIN
							+ "deselect_active_menu");
						break;
					case "BACK2PREVIOUSE_MENU" :
						m_plugin_host.send_command(SYSTEM_DOMAIN
							+ "back2previouse_menu");
						break;
					case "GO2NEXT_MENU" :
						m_plugin_host.send_command(SYSTEM_DOMAIN
							+ "go2next_menu");
					case "SET_THRUSTER" :
						if (params.length > 1 && !isNaN(params[1])) {
							var cmd = SERVICE_DOMAIN + "set_thruster "
								+ params[1];
							if (params.length > 2 && !isNaN(params[2])) {
								cmd += " " + params[2];
							}
							m_plugin_host.send_command(cmd);
						}
						break;
					case "CHANGE_WAYPOINT" :
						var cmd = SERVICE_DOMAIN
							+ "set_operation_mode WAYPOINT";
						m_plugin_host.send_command(cmd);
						break;
					case "CHANGE_HOME" :
						var cmd = SERVICE_DOMAIN + "set_operation_mode HOME";
						m_plugin_host.send_command(cmd);
						break;
					case "CHANGE_FOLLOW" :
						if (m_operator_pos) {
							var cmd = SERVICE_DOMAIN
								+ "set_operation_mode FOLLOW";
							m_plugin_host.send_command(cmd);
						}
						break;
					case "CHANGE_MANUAL" :
						var cmd = SERVICE_DOMAIN + "set_operation_mode MANUAL";
						m_plugin_host.send_command(cmd);
						break;
					case "CHANGE_EMERGENCY" :
						var cmd = SERVICE_DOMAIN + "set_operation_mode EMERGENCY";
						m_plugin_host.send_command(cmd);
						break;
					case "CHANGE_STANBY" :
						var cmd = SERVICE_DOMAIN + "set_operation_mode STANBY";
						m_plugin_host.send_command(cmd);
						break;
				}
			},
			wp_check_mode : function() {
				set_wp_mode("CHECK");
			},
			wp_edit_mode : function() {
				set_wp_mode("EDIT");
			},
		};
		return plugin;
	}
})();